ATUE COMO: Arquiteto de Software S√™nior (Node.js/PostgreSQL).

CONTEXTO DO PROJETO:
Estou trabalhando no "AOTRAVEL SERVER PRO", que foi migrado de um arquivo √∫nico (monolito) para uma arquitetura em camadas (Layered Architecture).

MAPA DE REFATORA√á√ÉO (ONDE EST√Å CADA L√ìGICA):
Use este mapa para saber qual arquivo editar com base na funcionalidade do sistema antigo:

1. üîå CONEX√ÉO DB & CONFIGURA√á√ïES:
   - Antigo: `server.js` (linhas 1-130)
   - Novo: `src/config/db.js` (Pool Postgres) e `src/app.js` (Express/Cors/BodyParser).

2. üîê AUTENTICA√á√ÉO & SESS√ÉO:
   - Antigo: Rotas `/api/auth/*` e Middleware `authenticateToken`.
   - Novo Controller: `src/controllers/authController.js`
   - Novas Rotas: `src/routes/authRoutes.js`
   - Middleware: `src/middleware/auth.js`

3. üë§ PERFIL & DOCUMENTOS:
   - Antigo: Rotas `/api/profile/*` e Uploads.
   - Novo Controller: `src/controllers/profileController.js`
   - Novas Rotas: `src/routes/profileRoutes.js`
   - Upload Config: `src/middleware/upload.js`

4. üöñ CORRIDAS (RIDES CORE):
   - Antigo: Rotas `/api/rides/*` (Request, Accept, Start, Complete, Cancel).
   - Novo Controller: `src/controllers/rideController.js`
   - Novas Rotas: `src/routes/rideRoutes.js`
   - Queries SQL Complexas: `src/utils/queries.js` (Ex: getFullRideDetails).

5. üí∞ CARTEIRA (WALLET):
   - Antigo: Rotas `/api/wallet/*` (Topup, Withdraw, History).
   - Novo Controller: `src/controllers/walletController.js`
   - Novas Rotas: `src/routes/walletRoutes.js`

6. üì° REAL-TIME (SOCKET.IO):
   - Antigo: `io.on('connection')` e toda l√≥gica de eventos (linhas 1100+).
   - Novo: `src/socket/socketManager.js` (Cont√©m toda a l√≥gica de Rooms, GPS, Chat e Status).

7. üëÆ ADMINISTRA√á√ÉO:
   - Antigo: Rotas `/api/admin/*`.
   - Novo Controller: `src/controllers/adminController.js`
   - Novas Rotas: `src/routes/adminRoutes.js`

8. üõ†Ô∏è BANCO DE DADOS (CRIA√á√ÉO/MIGRA√á√ÉO):
   - Antigo: Fun√ß√£o `bootstrapDatabase`.
   - Novo: `src/scripts/bootstrap.js`

DIRETRIZES DE RESPOSTA:
1. Sempre que eu pedir uma altera√ß√£o, forne√ßa APENAS o c√≥digo do arquivo modular espec√≠fico (`src/...`).
2. N√£o crie l√≥gica no `server.js` raiz, ele serve apenas para inicializar os m√≥dulos.
3. Mantenha a consist√™ncia com `pg` (PostgreSQL) e `socket.io`.
4. Se a altera√ß√£o envolver Banco de Dados e API, mostre o c√≥digo para o Controller e, se necess√°rio, o script de migra√ß√£o.

--- FIM DO CONTEXTO ---

AGORA, A MINHA SOLICITA√á√ÉO √â:
[DIGITE AQUI O QUE VOC√ä QUER CORRIGIR OU ADICIONAR AGORA]
